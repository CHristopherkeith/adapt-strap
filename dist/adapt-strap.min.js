/**
 * adapt-strap
 * @version v0.2.7 - 2014-08-22
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,a,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.utils","adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.loadingindicator"]).provider("$adConfig",function(){var e=this.iconClasses={expand:"glyphicon glyphicon-plus-sign",collapse:"glyphicon glyphicon-minus-sign",loadingSpinner:"glyphicon glyphicon-refresh ad-spin",firstPage:"glyphicon glyphicon-fast-backward",previousPage:"glyphicon glyphicon-backward",nextPage:"glyphicon glyphicon-forward",lastPage:"glyphicon glyphicon-fast-forward",sortAscending:"glyphicon glyphicon-chevron-up",sortDescending:"glyphicon glyphicon-chevron-down",sortable:"glyphicon glyphicon-resize-vertical"},a=this.paging={request:{start:"skip",pageSize:"limit",page:"page",sortField:"sort",sortDirection:"sort_dir",sortAscValue:"asc",sortDescValue:"desc"},response:{itemsLocation:"data",totalItems:"pagination.totalCount"}};this.$get=function(){return{iconClasses:e,paging:a}}}),angular.module("adaptv.adaptStrap.loadingindicator",[]).directive("adLoadingIcon",["$adConfig","$compile",function(e,a){return{restrict:"E",compile:function(){return{pre:function(t,n,i){var o=i.loadingIconClass||e.iconClasses.loadingSpinner,r=i.loadingIconSize?"ng-style=\"{'font-size': '"+i.loadingIconSize+"'}\"":"",l='<i class="'+o+'" '+r+"></i>";n.empty(),n.append(a(l)(t))}}}}}]).directive("adLoadingOverlay",["$adConfig",function(e){return{restrict:"E",templateUrl:"loadingindicator/loadingindicator.tpl.html",scope:{loading:"=",zIndex:"@",position:"@",containerClasses:"@",loadingIconClass:"@",loadingIconSize:"@"},compile:function(){return{pre:function(a){a.loadingIconClass=a.loadingIconClass||e.iconClasses.loading,a.loadingIconSize=a.loadingIconSize||"3em"}}}}}]),angular.module("adaptv.adaptStrap.tableajax",["adaptv.adaptStrap.utils","adaptv.adaptStrap.loadingindicator"]).directive("adTableAjax",["$parse","$compile","$templateCache","$adConfig","adLoadPage","adDebounce","adStrapUtils",function(e,a,n,i,o,r,l){function g(g,s,c){g[c.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(c.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],loadingData:!1},ajaxConfig:g.$eval(c.ajaxConfig),applyFilter:l.applyFilter,readProperty:l.getObjectProperty};var p,d=g[c.tableName],u=n.get("tableajax/tableajax.tpl.html");d.items.paging.pageSize=d.items.paging.pageSizes[0],d.loadPage=r(function(e){p=Math.random(),d.localConfig.loadingData=!0;var a=g.$eval(c.pageLoader)||o,t={pageNumber:e,pageSize:d.items.paging.pageSize,sortKey:d.localConfig.predicate,sortDirection:d.localConfig.reverse,ajaxConfig:d.ajaxConfig,token:p},n=function(e){e.token===p&&(d.items.list=e.items,d.items.paging.totalPages=e.totalPages,d.items.paging.currentPage=e.currentPage,d.localConfig.pagingArray=e.pagingArray,d.localConfig.loadingData=!1)},i=function(){d.localConfig.loadingData=!1};a(t).then(n,i)}),d.loadNextPage=function(){d.localConfig.loadingData||d.items.paging.currentPage+1<=d.items.paging.totalPages&&d.loadPage(d.items.paging.currentPage+1)},d.loadPreviousPage=function(){d.localConfig.loadingData||d.items.paging.currentPage-1>0&&d.loadPage(d.items.paging.currentPage-1)},d.loadLastPage=function(){d.localConfig.loadingData||d.items.paging.currentPage!==d.items.paging.totalPages&&d.loadPage(d.items.paging.totalPages)},d.pageSizeChanged=function(e){Number(e)!==d.items.paging.pageSize&&(d.items.paging.pageSize=Number(e),d.loadPage(1))},d.sortByColumn=function(e){e.sortKey&&(e.sortKey!==d.localConfig.predicate?(d.localConfig.predicate=e.sortKey,d.localConfig.reverse=!0):d.localConfig.reverse===!0?d.localConfig.reverse=!1:(d.localConfig.reverse=t,d.localConfig.predicate=t),d.loadPage(d.items.paging.currentPage))},d.loadPage(1),g.$watch(c.ajaxConfig,function(){d.loadPage(1)},!0),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",u=u.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=icon-firstPage%/g,i.iconClasses.firstPage).replace(/%=icon-previousPage%/g,i.iconClasses.previousPage).replace(/%=icon-nextPage%/g,i.iconClasses.nextPage).replace(/%=icon-lastPage%/g,i.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,i.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,i.iconClasses.sortDescending).replace(/%=icon-sortable%/g,i.iconClasses.sortable),s.empty(),s.append(a(u)(g))}return{restrict:"E",link:g}}]),angular.module("adaptv.adaptStrap.tablelite",["adaptv.adaptStrap.utils"]).directive("adTableLite",["$parse","$http","$compile","$filter","$templateCache","$adConfig","adStrapUtils","adDebounce",function(e,a,n,i,o,r,l,g){function s(a,s,c){a[c.tableName]={items:{list:t,allItems:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(c.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],selectable:c.selectedItems?!0:!1,showPaging:e(c.disablePaging)()?!1:!0},selectedItems:a.$eval(c.selectedItems),applyFilter:l.applyFilter,isSelected:l.itemExistsInList,addRemoveItem:l.addRemoveItemFromList,addRemoveAll:l.addRemoveItemsFromList,allSelected:l.itemsExistInList,readProperty:l.getObjectProperty};var p=a[c.tableName],d=o.get("tablelite/tablelite.tpl.html");p.items.paging.pageSize=p.items.paging.pageSizes[0],p.loadPage=g(function(e){var t,n,o=(e-1)*p.items.paging.pageSize,r=o+p.items.paging.pageSize,l=[];angular.isArray(a.$eval(c.localDataSource))?l=a.$eval(c.localDataSource):angular.forEach(a.$eval(c.localDataSource),function(e){l.push(e)}),p.localConfig.showPaging===!1&&(r=l.length),n=i("orderBy")(l,p.localConfig.predicate,p.localConfig.reverse),p.items.list=n.slice(o,r),p.items.allItems=l,p.items.paging.currentPage=e,p.items.paging.totalPages=Math.ceil(l.length/p.items.paging.pageSize),p.localConfig.pagingArray=[];var g=5,s=e-Math.floor(g/2);for(t=s;e>=t;t++)t>0&&p.localConfig.pagingArray.push(t);for(;p.localConfig.pagingArray.length<g&&!(t>p.items.paging.totalPages);)p.localConfig.pagingArray.push(t),t++},100),p.loadNextPage=function(){p.items.paging.currentPage+1<=p.items.paging.totalPages&&p.loadPage(p.items.paging.currentPage+1)},p.loadPreviousPage=function(){p.items.paging.currentPage-1>0&&p.loadPage(p.items.paging.currentPage-1)},p.loadLastPage=function(){p.localConfig.disablePaging||p.loadPage(p.items.paging.totalPages)},p.pageSizeChanged=function(e){p.items.paging.pageSize=e,p.loadPage(1)},p.sortByColumn=function(e){e.sortKey&&(e.sortKey!==p.localConfig.predicate?(p.localConfig.predicate=e.sortKey,p.localConfig.reverse=!0):p.localConfig.reverse===!0?p.localConfig.reverse=!1:(p.localConfig.reverse=t,p.localConfig.predicate=t),p.loadPage(p.items.paging.currentPage))},p.loadPage(1),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",d=d.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=icon-firstPage%/g,r.iconClasses.firstPage).replace(/%=icon-previousPage%/g,r.iconClasses.previousPage).replace(/%=icon-nextPage%/g,r.iconClasses.nextPage).replace(/%=icon-lastPage%/g,r.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,r.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,r.iconClasses.sortDescending).replace(/%=icon-sortable%/g,r.iconClasses.sortable),s.empty(),s.append(n(d)(a)),a.$watch(c.localDataSource,function(){p.loadPage(1)},!0)}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).directive("adTreeBrowser",["$compile","$http","$adConfig","$templateCache",function(e,a,t,n){function i(i,o,r){i[r.treeName]={toggle:function(e,a){var t;e.stopPropagation(),t=i.$eval(r.toggleCallback),t?t(a):a._ad_expanded=!a._ad_expanded},hasChildren:function(e){var a=i.$eval(r.hasChildren),t=e[r.childNode]&&e[r.childNode].length>0;return a&&(t=a(e)),t},localConfig:{showHeader:r.nodeHeaderUrl?!0:!1}};var l=r.treeName||"",g=r.nodeTemplateUrl||"",s=r.nodeHeaderUrl||"",c=r.childrenPadding||15,p="",d=function(a,g){var s=n.get("treebrowser/treebrowser.tpl.html");p=s.replace(/%=treeName%/g,l).replace(/%=treeRootName%/g,r.treeRoot).replace(/%=bordered%/g,r.bordered).replace(/%=icon-expand%/g,t.iconClasses.expand).replace(/%=icon-collapse%/g,t.iconClasses.collapse).replace(/%=icon-loadingSpinner%/g,t.iconClasses.loadingSpinner).replace(/%=childNodeName%/g,r.childNode).replace(/%=childrenPadding%/g,c).replace(/%=rowNgClass%/g,r.rowNgClass||"").replace(/%=nodeTemplate%/g,a).replace(/%=nodeHeaderTemplate%/g,g||""),o.empty(),o.append(e(p)(i))};""!==g?a.get(g,{cache:n}).success(function(e){""!==s?a.get(s,{cache:n}).success(function(a){d(e,a)}):d(e,"")}):d('<span>{{ item.name || "" }}</span>')}return{restrict:"E",link:i}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(e){var a=function(e,a){var t=a.split(".");if(e)for(;t.length;)e&&(e=e[t.shift()]);return e},t=function(a,t){var n,i;return t&&(n=t.split(":"),i=n[1],a=i?e(n[0])(a,i):e(n[0])(a)),a},n=function(e,a){var t=!1;return a.forEach(function(a){angular.equals(e,a)&&(t=!0)}),t},i=function(e,a){var t,i=!0;for(t=0;t<e.length;t++)if(n(e[t],a)===!1){i=!1;break}return i},o=function(e,a){a.push(e)},r=function(e,a){var t;for(t=a.length-1;t>-1;t--)angular.equals(e,a[t])&&a.splice(t,1)},l=function(e,a){var t,n=!1;for(t=a.length-1;t>-1;t--)angular.equals(e,a[t])&&(a.splice(t,1),n=!0);n===!1&&a.push(e)},g=function(e,a){e.forEach(function(e){n(e,a)||l(e,a)})},s=function(e,a){i(e,a)?a.length=0:g(e,a)},c=function(e,a){for(var t=a.split(".");t.length;)e=e[t.shift()];return e};return{evalObjectProperty:a,applyFilter:t,itemExistsInList:n,itemsExistInList:i,addItemToList:o,removeItemFromList:r,addRemoveItemFromList:l,addItemsToList:g,addRemoveItemsFromList:s,getObjectProperty:c}}]).factory("adDebounce",["$timeout","$q",function(e,a){var t=function(t,n,i,o){var r=null,l=a.defer(),g=n||300;return function(){var n=o||this,s=arguments,c=i&&!r,p=function(){i||(l.resolve(t.apply(n,s)),l=a.defer())};return r&&e.cancel(r),r=e(p,g),c&&(l.resolve(t.apply(n,s)),l=a.defer()),l.promise}};return t}]).factory("adLoadPage",["$adConfig","$http","adStrapUtils",function(e,a,t){return function(n){var i=(n.pageNumber-1)*n.pageSize,o=angular.copy(e.paging),r=angular.copy(n.ajaxConfig);r.paginationConfig&&r.paginationConfig.request&&angular.extend(o.request,r.paginationConfig.request),r.paginationConfig&&r.paginationConfig.response&&angular.extend(o.response,r.paginationConfig.response),r.params[o.request.start]=i,r.params[o.request.pageSize]=n.pageSize,r.params[o.request.page]=n.pageNumber,n.sortKey&&(r.params[o.request.sortField]=n.sortKey),n.sortDirection===!1?r.params[o.request.sortDirection]=o.request.sortAscValue:n.sortDirection===!0&&(r.params[o.request.sortDirection]=o.request.sortDescValue);var l;return l="JSONP"===r.method?a.jsonp(r.url+"?callback=JSON_CALLBACK",r):a(r),l.then(function(e){for(var a={items:t.evalObjectProperty(e.data,o.response.itemsLocation),currentPage:n.pageNumber,totalPages:Math.ceil(t.evalObjectProperty(e.data,o.response.totalItems)/n.pageSize),pagingArray:[],token:n.token},i=5,r=n.pageNumber-Math.floor(i/2),l=r;l<=n.pageNumber;l++)l>0&&a.pagingArray.push(l);for(;a.pagingArray.length<i&&!(l>a.totalPages);)a.pagingArray.push(l),l++;return a})}}])}(window,document);