/**
 * adapt-strap
 * @version v1.0.2-beta.1 - 2014-09-25
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,e,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.utils","adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.loadingindicator","adaptv.adaptStrap.draggable","adaptv.adaptStrap.infinitedropdown"]).provider("$adConfig",function(){var a=this.iconClasses={expand:"glyphicon glyphicon-plus-sign",collapse:"glyphicon glyphicon-minus-sign",loadingSpinner:"glyphicon glyphicon-refresh ad-spin",firstPage:"glyphicon glyphicon-fast-backward",previousPage:"glyphicon glyphicon-backward",nextPage:"glyphicon glyphicon-forward",lastPage:"glyphicon glyphicon-fast-forward",sortAscending:"glyphicon glyphicon-chevron-up",sortDescending:"glyphicon glyphicon-chevron-down",sortable:"glyphicon glyphicon-resize-vertical",draggable:"glyphicon glyphicon-align-justify",selectedItem:"glyphicon glyphicon-ok"},e=this.paging={request:{start:"skip",pageSize:"limit",page:"page",sortField:"sort",sortDirection:"sort_dir",sortAscValue:"asc",sortDescValue:"desc"},response:{itemsLocation:"data",totalItems:"pagination.totalCount"}};this.$get=function(){return{iconClasses:a,paging:e}}}),angular.module("adaptv.adaptStrap.draggable",[]).directive("adDrag",["$rootScope","$parse","$timeout",function(t,n,o){function i(i,l,r){function g(){l.attr("draggable","false"),s(!0)}function s(a){a&&(i.$on("$destroy",d),r.$observe("adDrag",f),i.$watch(r.adDragData,u),i.$on("draggable:start",c),i.$on("draggable:end",p),i.hasHandle?l.on(A,".ad-drag-handle",m):(l.on(A,m),l.addClass("ad-draggable")),E||(l.on("mousedown",".ad-drag-handle",function(){return!1}),l.on("mousedown",function(){return!1})))}function c(a,e){e.el===l&&e.callback&&e.callback(a)}function p(a,e){e.el===l&&e.callback&&e.callback(a)}function d(){s(!1)}function u(a){i.data=a}function f(a){B=i.$eval(a)}function m(a){B&&(E?(C(),F=setTimeout(function(){C(),b(a)},100),H.on(j,C),H.on(T,C)):b(a))}function h(a,e){var t,n=$(e).attr("style");return n&&n.split(";").forEach(function(e){var n=e.split(":");$.trim(n[0])===a&&(t=n[1])}),t}function v(){h("width",l)&&l.data("ad-draggable-temp-width",h("width",l)),l.width(l.width()),l.children().each(function(){h("width",this)&&$(this).data("ad-draggable-temp-width",h("width",this)),$(this).width($(this).width())})}function C(){clearTimeout(F),H.off(j,C),H.off(T,C)}function b(a){B&&(a.preventDefault(),I=l.offset(),I=i.hasHandle?l.find(".ad-drag-handle").offset():l.offset(),l.addClass("ad-dragging"),N=a.pageX||a.originalEvent.touches[0].pageX,z=a.pageY||a.originalEvent.touches[0].pageY,L=N-I.left-q.scrollLeft(),k=z-I.top-q.scrollTop(),v(),w(L,k),H.on(j,P),H.on(T,y),t.$broadcast("draggable:start",{x:N,y:z,tx:L,ty:k,el:l,data:i.data,callback:S}))}function P(a){var e,n;B&&(a.preventDefault(),e=a.pageX||a.originalEvent.touches[0].pageX,n=a.pageY||a.originalEvent.touches[0].pageY,L=e-N+I.left-q.scrollLeft(),k=n-z+I.top-q.scrollTop(),w(L,k),t.$broadcast("draggable:move",{x:N,y:z,tx:L,ty:k,el:l,data:i.data}))}function y(a){B&&(a.preventDefault(),t.$broadcast("draggable:end",{x:N,y:z,tx:L,ty:k,el:l,data:i.data,callback:D}),l.removeClass("ad-dragging"),x(),H.off(j,P),H.off(T,y))}function S(a){i.onDragStartCallback&&i.$apply(function(){i.onDragStartCallback(i,{$data:i.data,$dragElement:l,$event:a})})}function D(a){i.onDragEndCallback&&o(function(){i.$apply(function(){i.onDragEndCallback(i,{$data:i.data,$dragElement:l,$event:a})})},100)}function x(){l.css({left:"",top:"",position:"","z-index":""});var a=l.data("ad-draggable-temp-width");a?l.css({width:a}):l.css({width:""}),l.children().each(function(){var a=$(this).data("ad-draggable-temp-width");a?$(this).css({width:a}):$(this).css({width:""})})}function w(a,e){l.css({left:a,top:e,position:"fixed","z-index":99999})}i.draggable=r.adDrag,i.hasHandle="false"===r.adDragHandle||"undefined"==typeof r.adDragHandle?!1:!0,i.onDragStartCallback=n(r.adDragBegin)||null,i.onDragEndCallback=n(r.adDragEnd)||null,i.data=null;var I,N,z,L,k,E="ontouchstart"in e.documentElement,A="touchstart mousedown",j="touchmove mousemove",T="touchend mouseup",H=$(e),q=$(a),B=!1,F=null;g()}return{restrict:"A",link:i}}]).directive("adDrop",["$rootScope","$parse",function(e,t){function n(n,o,i){function l(){r(!0)}function r(a){a&&(i.$observe("adDrop",s),n.$on("$destroy",g),n.$on("draggable:move",p),n.$on("draggable:end",d),n.$on("draggable:change",c))}function g(){r(!1)}function s(a){f=n.$eval(a)}function c(a,e){m!==e.el&&(m=null)}function p(a,t){if(f&&o!==t.el){var i=u(t.tx,t.ty,t.el);null!==i&&(m=i,n.$apply(function(){n.onDropOverCallback(n,{$data:t.data,$dragElement:t.el,$dropElement:m,$event:a})}),e.$broadcast("draggable:change",{el:m}))}}function d(a,e){f&&m&&(n.$apply(function(){n.onDropCallback(n,{$data:e.data,$dragElement:e.el,$dropElement:m,$event:a})}),m=null)}function u(a,e,t){var n,i,l=o.offset(),r=Math.floor(o.outerHeight()/3);return a+=h.scrollLeft(),e+=h.scrollTop(),n=a+t.outerWidth(),i=e+t.outerHeight(),e>=l.top+r&&e<=l.top+o.outerHeight()-r&&a>=l.left&&a<=l.left+o.outerWidth()||i>=l.top+r&&i<=l.top+o.outerHeight()-r&&a>=l.left&&a<=l.left+o.outerWidth()?o:null}n.droppable=i.adDrop,n.onDropCallback=t(i.adDropEnd)||null,n.onDropOverCallback=t(i.adDropOver)||null;var f=!1,m=null,h=$(a);l()}return{restrict:"A",link:n}}]),angular.module("adaptv.adaptStrap.infinitedropdown",["adaptv.adaptStrap.utils","adaptv.adaptStrap.loadingindicator"]).directive("adInfiniteDropdown",["$parse","$compile","$templateCache","$adConfig","adLoadPage","adDebounce","adStrapUtils","adLoadLocalPage",function(a,e,n,o,i,l,r,g){function s(s,c,p){s[p.dropdownName]={items:{list:[],paging:{currentPage:1,totalPages:t,pageSize:Number(p.pageSize)||10}},localConfig:{loadingData:!1,showDisplayProperty:p.displayProperty?!0:!1,showTemplate:p.template?!0:!1,loadTemplate:p.templateUrl?!0:!1,initialLabel:p.initialLabel||"Select",singleSelectionMode:a(p.singleSelectionMode)()?!0:!1,dynamicLabel:p.labelDisplayProperty?!0:!1,dimensions:{"max-height":p.maxHeight||"200px","max-width":p.maxWidth||"auto"}},selectedItems:s.$eval(p.selectedItems)||[],ajaxConfig:s.$eval(p.ajaxConfig),applyFilter:r.applyFilter,readProperty:r.getObjectProperty,isSelected:r.itemExistsInList};var d,u=s[p.dropdownName],f=n.get("infinitedropdown/infinitedropdown.tpl.html");u.addRemoveItem=function(a,e,t){a.stopPropagation(),u.localConfig.singleSelectionMode?u.selectedItems[0]=e:r.addRemoveItemFromList(e,t);var n=s.$eval(p.onItemClick);n&&n(e)},u.loadPage=l(function(a){d=Math.random(),u.localConfig.loadingData=!0;var e=s.$eval(p.pageLoader)||i,t={pageNumber:a,pageSize:u.items.paging.pageSize,sortKey:u.localConfig.predicate,sortDirection:u.localConfig.reverse,ajaxConfig:u.ajaxConfig,token:d},n=function(e){e.token===d&&(u.items.list=1===a?e.items:u.items.list.concat(e.items),u.items.paging.totalPages=e.totalPages,u.items.paging.currentPage=e.currentPage,u.localConfig.loadingData=!1)},o=function(){u.localConfig.loadingData=!1};p.localDataSource?(t.localData=s.$eval(p.localDataSource),n(g(t))):e(t).then(n,o)},10),u.loadNextPage=function(){u.localConfig.loadingData||u.items.paging.currentPage+1<=u.items.paging.totalPages&&u.loadPage(u.items.paging.currentPage+1)},u.loadPage(1),p.ajaxConfig&&s.$watch(p.ajaxConfig,function(){u.loadPage(1)},!0),p.localDataSource&&s.$watch(p.localDataSource,function(){u.loadPage(1)},!0),f=f.replace(/%=dropdownName%/g,p.dropdownName).replace(/%=displayProperty%/g,p.displayProperty).replace(/%=templateUrl%/g,p.templateUrl).replace(/%=template%/g,p.template).replace(/%=labelDisplayProperty%/g,p.labelDisplayProperty).replace(/%=btnClasses%/g,p.btnClasses||"btn btn-default").replace(/%=icon-selectedItem%/g,o.iconClasses.selectedItem),c.empty(),c.append(e(f)(s));var m=angular.element(c).find("ul")[0],h=l(function(){m.scrollTop+m.offsetHeight>=m.scrollHeight-300&&u.loadNextPage()},50);angular.element(m).bind("mousewheel",function(a){a.originalEvent&&a.originalEvent.deltaY&&(m.scrollTop+=a.originalEvent.deltaY,a.preventDefault(),a.stopPropagation()),h()})}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.loadingindicator",[]).directive("adLoadingIcon",["$adConfig","$compile",function(a,e){return{restrict:"E",compile:function(){return{pre:function(t,n,o){var i=o.loadingIconClass||a.iconClasses.loadingSpinner,l=o.loadingIconSize?"ng-style=\"{'font-size': '"+o.loadingIconSize+"'}\"":"",r='<i class="'+i+'" '+l+"></i>";n.empty(),n.append(e(r)(t))}}}}}]).directive("adLoadingOverlay",["$adConfig",function(a){return{restrict:"E",templateUrl:"loadingindicator/loadingindicator.tpl.html",scope:{loading:"=",zIndex:"@",position:"@",containerClasses:"@",loadingIconClass:"@",loadingIconSize:"@"},compile:function(){return{pre:function(e){e.loadingIconClass=e.loadingIconClass||a.iconClasses.loading,e.loadingIconSize=e.loadingIconSize||"3em"}}}}}]),angular.module("adaptv.adaptStrap.tableajax",["adaptv.adaptStrap.utils","adaptv.adaptStrap.loadingindicator"]).directive("adTableAjax",["$parse","$compile","$templateCache","$adConfig","adLoadPage","adDebounce","adStrapUtils",function(a,e,n,o,i,l,r){function g(g,s,c){g[c.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:a(c.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],loadingData:!1,tableMaxHeight:c.tableMaxHeight},watchTimeout:c.watchTimeout||1e3,ajaxConfig:g.$eval(c.ajaxConfig),applyFilter:r.applyFilter,readProperty:r.getObjectProperty};var p,d=g[c.tableName],u=n.get("tableajax/tableajax.tpl.html");d.items.paging.pageSize=d.items.paging.pageSizes[0],d.loadPage=l(function(a){p=Math.random(),d.localConfig.loadingData=!0;var e=g.$eval(c.pageLoader)||i,t={pageNumber:a,pageSize:d.items.paging.pageSize,sortKey:d.localConfig.predicate,sortDirection:d.localConfig.reverse,ajaxConfig:d.ajaxConfig,token:p},n=function(a){a.token===p&&(d.items.list=a.items,d.items.paging.totalPages=a.totalPages,d.items.paging.currentPage=a.currentPage,d.localConfig.pagingArray=a.pagingArray,d.localConfig.loadingData=!1)},o=function(){d.localConfig.loadingData=!1};e(t).then(n,o)}),d.loadNextPage=function(){d.localConfig.loadingData||d.items.paging.currentPage+1<=d.items.paging.totalPages&&d.loadPage(d.items.paging.currentPage+1)},d.loadPreviousPage=function(){d.localConfig.loadingData||d.items.paging.currentPage-1>0&&d.loadPage(d.items.paging.currentPage-1)},d.loadLastPage=function(){d.localConfig.loadingData||d.items.paging.currentPage!==d.items.paging.totalPages&&d.loadPage(d.items.paging.totalPages)},d.pageSizeChanged=function(a){Number(a)!==d.items.paging.pageSize&&(d.items.paging.pageSize=Number(a),d.loadPage(1))},d.sortByColumn=function(a){a.sortKey&&(a.sortKey!==d.localConfig.predicate?(d.localConfig.predicate=a.sortKey,d.localConfig.reverse=!0):d.localConfig.reverse===!0?d.localConfig.reverse=!1:(d.localConfig.reverse=t,d.localConfig.predicate=t),d.loadPage(d.items.paging.currentPage))},d.loadPage(1),g.$watch(c.ajaxConfig,function(){l(function(){d.loadPage(1)},c.watchTimeout)},!0),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",u=u.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=icon-firstPage%/g,o.iconClasses.firstPage).replace(/%=icon-previousPage%/g,o.iconClasses.previousPage).replace(/%=icon-nextPage%/g,o.iconClasses.nextPage).replace(/%=icon-lastPage%/g,o.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,o.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,o.iconClasses.sortDescending).replace(/%=icon-sortable%/g,o.iconClasses.sortable),s.empty(),s.append(e(u)(g))}return{restrict:"E",link:g}}]),angular.module("adaptv.adaptStrap.tablelite",["adaptv.adaptStrap.utils"]).directive("adTableLite",["$parse","$http","$compile","$filter","$templateCache","$adConfig","adStrapUtils","adDebounce","adLoadLocalPage",function(a,e,n,o,i,l,r,g,s){function c(e,o,c){function p(a,e,t){e.next()[0]===a[0]||e.next()[0]===t[0]?e.before(a):(e.prev()[0]===a[0]||e.prev()[0]===t[0])&&e.after(a)}e[c.tableName]={items:{list:t,allItems:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:a(c.pageSizes)()||[10,25,50]}},localConfig:{localData:r.parse(e.$eval(c.localDataSource)),pagingArray:[],selectable:c.selectedItems?!0:!1,draggable:c.draggable?!0:!1,dragChange:e.$eval(c.onDragChange),showPaging:a(c.disablePaging)()?!1:!0,tableMaxHeight:c.tableMaxHeight},selectedItems:e.$eval(c.selectedItems),applyFilter:r.applyFilter,isSelected:r.itemExistsInList,addRemoveItem:r.addRemoveItemFromList,addRemoveAll:r.addRemoveItemsFromList,allSelected:r.itemsExistInList,readProperty:r.getObjectProperty};var d,u=e[c.tableName],f=i.get("tablelite/tablelite.tpl.html"),m=null,h=null,v=!1,C=null;u.items.paging.pageSize=u.items.paging.pageSizes[0],u.loadPage=g(function(a){var t,n=u.localConfig.localData=r.parse(e.$eval(c.localDataSource));t={pageNumber:a,pageSize:u.localConfig.showPaging?u.items.paging.pageSize:n.length,sortKey:u.localConfig.predicate,sortDirection:u.localConfig.reverse,localData:n};var o=s(t);u.items.list=o.items,u.items.allItems=o.allItems,u.items.paging.currentPage=o.currentPage,u.items.paging.totalPages=o.totalPages,u.localConfig.pagingArray=o.pagingArray},100),u.loadNextPage=function(){u.items.paging.currentPage+1<=u.items.paging.totalPages&&u.loadPage(u.items.paging.currentPage+1)},u.loadPreviousPage=function(){u.items.paging.currentPage-1>0&&u.loadPage(u.items.paging.currentPage-1)},u.loadLastPage=function(){u.localConfig.disablePaging||u.loadPage(u.items.paging.totalPages)},u.pageSizeChanged=function(a){u.items.paging.pageSize=a,u.loadPage(1)},u.sortByColumn=function(a){a.sortKey&&(a.sortKey!==u.localConfig.predicate?(u.localConfig.predicate=a.sortKey,u.localConfig.reverse=!0):u.localConfig.reverse===!0?u.localConfig.reverse=!1:(u.localConfig.reverse=t,u.localConfig.predicate=t),u.loadPage(u.items.paging.currentPage))},u.onDragStart=function(a,e){var t=e.parent();m=$("<tr><td colspan="+e.find("td").length+">&nbsp;</td></tr>"),d=e.index()+(u.items.paging.currentPage-1)*u.items.paging.pageSize-1,e[0]!==t.children().last()[0]?e.next().before(m):t.append(m)},u.onDragEnd=function(){m.remove()},u.onDragOver=function(a,e,t){m&&(C?C[0]!==t[0]&&(p(m,t,e),C=t):(p(m,t,e),C=t))},u.onDropEnd=function(a,e){var t;m&&(m.next()[0]?m.next().before(e):m.prev()[0]&&m.prev().after(e),m.remove(),v=!0,t=e.index()+(u.items.paging.currentPage-1)*u.items.paging.pageSize-1,r.moveItemInList(d,t,u.localConfig.localData),u.localConfig.dragChange&&u.localConfig.dragChange(d,t,a)),h&&(h.removeClass("btn-primary"),h=null)},u.onNextPageButtonOver=function(a,e,t){h&&(h.removeClass("btn-primary"),h=null),"disabled"!==t.attr("disabled")&&(h=t,h.addClass("btn-primary"))},u.onNextPageButtonDrop=function(a,e){var t;h&&(v=!0,"btnPrev"===h.attr("id")&&(t=u.items.paging.pageSize*(u.items.paging.currentPage-1)-1),"btnNext"===h.attr("id")&&(t=u.items.paging.pageSize*u.items.paging.currentPage),r.moveItemInList(d,t,u.localConfig.localData),m.remove(),e.remove(),u.localConfig.dragChange&&u.localConfig.dragChange(d,t,a),h.removeClass("btn-primary"),h=null)},u.loadPage(1),c.tableClasses=c.tableClasses||"table",c.paginationBtnGroupClasses=c.paginationBtnGroupClasses||"btn-group btn-group-sm",f=f.replace(/%=tableName%/g,c.tableName).replace(/%=columnDefinition%/g,c.columnDefinition).replace(/%=paginationBtnGroupClasses%/g,c.paginationBtnGroupClasses).replace(/%=tableClasses%/g,c.tableClasses).replace(/%=icon-firstPage%/g,l.iconClasses.firstPage).replace(/%=icon-previousPage%/g,l.iconClasses.previousPage).replace(/%=icon-nextPage%/g,l.iconClasses.nextPage).replace(/%=icon-lastPage%/g,l.iconClasses.lastPage).replace(/%=icon-sortAscending%/g,l.iconClasses.sortAscending).replace(/%=icon-sortDescending%/g,l.iconClasses.sortDescending).replace(/%=icon-sortable%/g,l.iconClasses.sortable).replace(/%=icon-draggable%/g,l.iconClasses.draggable),o.empty(),o.append(n(f)(e)),e.$watch(c.localDataSource,function(){u.loadPage(u.items.paging.currentPage)},!0)}return{restrict:"E",link:c}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).directive("adTreeBrowser",["$compile","$http","$adConfig","$templateCache",function(a,e,t,n){function o(o,i,l){o[l.treeName]={toggle:function(a,e){var t;a.stopPropagation(),t=o.$eval(l.toggleCallback),t?t(e):e._ad_expanded=!e._ad_expanded},hasChildren:function(a){var e=o.$eval(l.hasChildren),t=a[l.childNode]&&a[l.childNode].length>0;return e&&(t=e(a)),t},localConfig:{showHeader:l.nodeHeaderUrl?!0:!1}};var r=l.treeName||"",g=l.nodeTemplateUrl||"",s=l.nodeHeaderUrl||"",c=l.childrenPadding||15,p="",d=function(e,g){var s=n.get("treebrowser/treebrowser.tpl.html");p=s.replace(/%=treeName%/g,r).replace(/%=treeRootName%/g,l.treeRoot).replace(/%=bordered%/g,l.bordered).replace(/%=icon-expand%/g,t.iconClasses.expand).replace(/%=icon-collapse%/g,t.iconClasses.collapse).replace(/%=icon-loadingSpinner%/g,t.iconClasses.loadingSpinner).replace(/%=childNodeName%/g,l.childNode).replace(/%=childrenPadding%/g,c).replace(/%=rowNgClass%/g,l.rowNgClass||"").replace(/%=nodeTemplate%/g,e).replace(/%=nodeHeaderTemplate%/g,g||""),i.empty(),i.append(a(p)(o))};""!==g?e.get(g,{cache:n}).success(function(a){""!==s?e.get(s,{cache:n}).success(function(e){d(a,e)}):d(a,"")}):d('<span>{{ item.name || "" }}</span>')}return{restrict:"E",link:o}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(a){var e=function(a,e){var t=e.split(".");if(a)for(;t.length;)a&&(a=a[t.shift()]);return a},t=function(e,t){var n,o;return t&&(n=t.split(":"),o=n[1],e=o?a(n[0])(e,o):a(n[0])(e)),e},n=function(a,e){var t=!1;return e.forEach(function(e){angular.equals(a,e)&&(t=!0)}),t},o=function(a,e){var t,o=!0;for(t=0;t<a.length;t++)if(n(a[t],e)===!1){o=!1;break}return o},i=function(a,e){e.push(a)},l=function(a,e){var t;for(t=e.length-1;t>-1;t--)angular.equals(a,e[t])&&e.splice(t,1)},r=function(a,e){var t,n=!1;for(t=e.length-1;t>-1;t--)angular.equals(a,e[t])&&(e.splice(t,1),n=!0);n===!1&&e.push(a)},g=function(a,e){a.forEach(function(a){n(a,e)||r(a,e)})},s=function(a,e){o(a,e)?e.length=0:g(a,e)},c=function(a,e,t){e<t.length&&t.splice(e,0,t.splice(a,1)[0])},p=function(a){var e=[];return angular.isArray(a)?e=a:angular.forEach(a,function(a){e.push(a)}),e},d=function(a,e){if(e&&"function"==typeof e)return e(a);for(var t=e.split(".");t.length;)a=a[t.shift()];return a};return{evalObjectProperty:e,applyFilter:t,itemExistsInList:n,itemsExistInList:o,addItemToList:i,removeItemFromList:l,addRemoveItemFromList:r,addItemsToList:g,addRemoveItemsFromList:s,moveItemInList:c,parse:p,getObjectProperty:d}}]).factory("adDebounce",["$timeout","$q",function(a,e){var t=function(t,n,o,i){var l=null,r=e.defer(),g=n||300;return function(){var n=i||this,s=arguments,c=o&&!l,p=function(){o||(r.resolve(t.apply(n,s)),r=e.defer())};return l&&a.cancel(l),l=a(p,g),c&&(r.resolve(t.apply(n,s)),r=e.defer()),r.promise}};return t}]).directive("adCompileTemplate",["$compile",function(a){return function(e,t,n){e.$watch(function(a){return a.$eval(n.adCompileTemplate)},function(n){t.html(n),a(t.contents())(e)})}}]).factory("adLoadPage",["$adConfig","$http","adStrapUtils",function(a,e,t){return function(n){var o=(n.pageNumber-1)*n.pageSize,i=angular.copy(a.paging),l=angular.copy(n.ajaxConfig);l.paginationConfig&&l.paginationConfig.request&&angular.extend(i.request,l.paginationConfig.request),l.paginationConfig&&l.paginationConfig.response&&angular.extend(i.response,l.paginationConfig.response),l.params[i.request.start]=o,l.params[i.request.pageSize]=n.pageSize,l.params[i.request.page]=n.pageNumber,n.sortKey&&(l.params[i.request.sortField]=n.sortKey),n.sortDirection===!1?l.params[i.request.sortDirection]=i.request.sortAscValue:n.sortDirection===!0&&(l.params[i.request.sortDirection]=i.request.sortDescValue);var r;return r="JSONP"===l.method?e.jsonp(l.url+"?callback=JSON_CALLBACK",l):e(l),r.then(function(a){for(var e={items:t.evalObjectProperty(a.data,i.response.itemsLocation),currentPage:n.pageNumber,totalPages:Math.ceil(t.evalObjectProperty(a.data,i.response.totalItems)/n.pageSize),pagingArray:[],token:n.token},o=5,l=n.pageNumber-Math.floor(o/2),r=l;r<=n.pageNumber;r++)r>0&&e.pagingArray.push(r);for(;e.pagingArray.length<o&&!(r>e.totalPages);)e.pagingArray.push(r),r++;return e})}}]).factory("adLoadLocalPage",["$filter",function(a){return function(e){var n,o,i={items:t,currentPage:e.pageNumber,totalPages:t,pagingArray:[],token:e.token},l=(e.pageNumber-1)*e.pageSize,r=l+e.pageSize,g=e.localData;o=a("orderBy")(g,e.sortKey,e.sortDirection),i.items=o.slice(l,r),i.allItems=g,i.currentPage=e.pageNumber,i.totalPages=Math.ceil(g.length/e.pageSize);var s=5,c=e.pageNumber-Math.floor(s/2);for(n=c;n<=e.pageNumber;n++)n>0&&i.pagingArray.push(n);for(;i.pagingArray.length<s&&!(n>i.totalPages);)i.pagingArray.push(n),n++;return i}}])}(window,document);