/**
 * adapt-strap
 * @version v0.0.3 - 2014-07-27
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,a,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.utils"]),angular.module("adaptv.adaptStrap.tableajax",[]).provider("$tableajax",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTableAjax",["$q","$http","$compile","$filter","$templateCache","$adPaging","adStrapUtils",function(e,a,l,n,i,r,s){function o(e,a,n){e[n.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:5}},localConfig:{pagingArray:[]},ajaxConfig:e.$eval(n.ajaxConfig)};var o=e[n.tableName],g=i.get("tablelite/tablelite.tpl.html");e.formatValue=function(e,a){return s.applyFilter(e,a)},e.loadPage=function(e){r.loadPage(e,o.items.paging.pageSize,o.ajaxConfig).then(function(e){o.items.list=e.items,o.items.paging.totalPages=e.totalPages,o.items.paging.currentPage=e.currentPage,o.localConfig.pagingArray=e.pagingArray})},e.loadNextPage=function(){o.items.paging.currentPage+1<=o.items.paging.totalPages&&e.loadPage(o.items.paging.currentPage+1)},e.loadPreviousPage=function(){o.items.paging.currentPage-1>0&&e.loadPage(o.items.paging.currentPage-1)},e.loadPage(1),n.tableClasses=n.tableClasses||"table",g=g.replace(/%=tableName%/g,n.tableName).replace(/%=columnDefinition%/g,n.columnDefinition).replace(/%=tableClasses%/g,n.tableClasses),angular.element(a).html(l(g)(e))}return{restrict:"E",link:o}}]),angular.module("adaptv.adaptStrap.tablelite",[]).provider("$tablelite",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTableLite",["$q","$http","$compile","$filter","$templateCache","adStrapUtils",function(e,a,l,n,i,r){function s(e,a,n){e[n.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:5}},localConfig:{pagingArray:[]}};var s=e[n.tableName],o=i.get("tablelite/tablelite.tpl.html");e.formatValue=function(e,a){return r.applyFilter(e,a)},e.loadPage=function(a){var t,l,i=(a-1)*s.items.paging.pageSize,r=i+s.items.paging.pageSize;for(s.items.list=e.$eval(n.localDataSource).slice(i,r),s.items.paging.currentPage=a,s.items.paging.totalPages=Math.ceil(e.$eval(n.localDataSource).length/s.items.paging.pageSize),s.localConfig.pagingArray=[],l=5*Math.ceil(a/5)-4,t=0;5>t;t++)l+t>0&&l+t<=s.items.paging.totalPages&&s.localConfig.pagingArray.push(l+t)},e.loadNextPage=function(){s.items.paging.currentPage+1<=s.items.paging.totalPages&&e.loadPage(s.items.paging.currentPage+1)},e.loadPreviousPage=function(){s.items.paging.currentPage-1>0&&e.loadPage(s.items.paging.currentPage-1)},e.loadPage(1),n.tableClasses=n.tableClasses||"table",o=o.replace(/%=tableName%/g,n.tableName).replace(/%=columnDefinition%/g,n.columnDefinition).replace(/%=tableClasses%/g,n.tableClasses),angular.element(a).html(l(o)(e))}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).provider("$treebrowser",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTreeBrowser",["$compile","$http","$treebrowser","$templateCache",function(e,a,t,l){return{restrict:"E",link:function(n,i,r){var s=r.treeName||"",o=r.nodeTemplateUrl||"",g=r.nodeHeaderUrl||"",p=r.childrenPadding||15,c="",u=function(a,o){var g=l.get("treebrowser/treebrowser.tpl.html");c=g.replace(/%=treeName%/g,s).replace(/%=treeRootName%/g,r.treeRoot).replace(/%=bordered%/g,r.bordered).replace(/%=expandIconClass%/g,r.expandIconClass||t.settings.expandIconClass).replace(/%=collapseIconClass%/g,r.collapseIconClass||t.settings.collapseIconClass).replace(/%=loadingIconClass%/g,r.loadingIconClass||t.settings.loadingIconClass).replace(/%=childNodeName%/g,r.childNode).replace(/%=childrenPadding%/g,p).replace(/%=rowNgClass%/g,r.rowNgClass||"").replace(/%=nodeTemplate%/g,a).replace(/%=nodeHeaderTemplate%/g,o||""),i.empty(),i.append(e(c)(n))};n[s+"TreeBrowser"]={toggle:function(e,a){var t;e.stopPropagation(),t=n.$eval(r.toggleCallback),t?t(a):a._expanded=!a._expanded},hasChildren:function(e){var a=n.$eval(r.hasChildren),t=e[r.childNode]&&e[r.childNode].length>0;return a&&(t=a(e)),t},showHeader:""!==g?!0:!1},""!==o?a.get(o).success(function(e){""!==g?a.get(g).success(function(a){u(e,a)}):u(e,"")}):u('<span>{{ item.name || "" }}</span>')}}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(e){return{evalObjectProperty:function(e,a){for(var t=a.split(".");t.length;)e=e[t.shift()];return e},applyFilter:function(a,t){var l,n;return t&&(l=t.split(":"),n=l[1],a=n?e(l[0])(a,n):e(l[0])(a)),a}}}]).provider("$adPaging",function(){var e=this.defaults={request:{start:"skip",pageSize:"limit",page:"page"},response:{totalItems:"results.opensearch:totalResults",itemsLocation:"results.artistmatches.artist"}};this.$get=function(a,t,l){return{loadPage:function(n,i,r){var s,o,g,p=(n-1)*i,c=a.defer();return r.params[e.request.start]=p,r.params[e.request.pageSize]=i,r.params[e.request.page]=n,g=function(a){var t={items:l.evalObjectProperty(a,e.response.itemsLocation),currentPage:n,totalPages:Math.ceil(l.evalObjectProperty(a,e.response.totalItems)/i),pagingArray:[]};for(o=Math.ceil(n/i)*i-(i-1),s=0;5>s;s++)o+s>0&&o+s<=t.totalPages&&t.pagingArray.push(o+s);c.resolve(t)},"JSONP"===r.method?t.jsonp(r.url+"?callback=JSON_CALLBACK",r).success(g):t(r).success(g),c.promise}}}})}(window,document);