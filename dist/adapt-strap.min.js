/**
 * adapt-strap
 * @version v0.0.5 - 2014-07-27
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,e,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.utils"]),angular.module("adaptv.adaptStrap.tableajax",[]).provider("$tableajax",function(){var a=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:a}}}).directive("adTableAjax",["$parse","$compile","$templateCache","$adPaging","adDebounce","adStrapUtils",function(a,e,n,i,l,g){function s(s,r,o){s[o.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:a(o.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],disablePaging:!1},ajaxConfig:s.$eval(o.ajaxConfig),applyFilter:g.applyFilter};var p=s[o.tableName],c=n.get("tableajax/tableajax.tpl.html");p.items.paging.pageSize=p.items.paging.pageSizes[0],p.loadPage=l(function(a){p.localConfig.disablePaging||(p.localConfig.disablePaging=!0,i.loadPage(a,p.items.paging.pageSize,p.ajaxConfig).then(function(a){p.items.list=a.items,p.items.paging.totalPages=a.totalPages,p.items.paging.currentPage=a.currentPage,p.localConfig.pagingArray=a.pagingArray,p.localConfig.disablePaging=!1},function(){p.localConfig.disablePaging=!1}))},50,!1),p.loadNextPage=function(){p.items.paging.currentPage+1<=p.items.paging.totalPages&&p.loadPage(p.items.paging.currentPage+1)},p.loadPreviousPage=function(){p.items.paging.currentPage-1>0&&p.loadPage(p.items.paging.currentPage-1)},p.pageSizeChanged=function(a){p.items.paging.pageSize=a,p.loadPage(1)},p.loadPage(1),s.$watch(o.ajaxConfig,function(){p.loadPage(1)},!0),o.tableClasses=o.tableClasses||"table",o.paginationClasses=o.paginationClasses||"pagination",c=c.replace(/%=tableName%/g,o.tableName).replace(/%=columnDefinition%/g,o.columnDefinition).replace(/%=tableClasses%/g,o.tableClasses).replace(/%=paginationClasses%/g,o.paginationClasses),angular.element(r).html(e(c)(s))}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.tablelite",[]).provider("$tablelite",function(){var a=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:a}}}).directive("adTableLite",["$parse","$http","$compile","$filter","$templateCache","adStrapUtils",function(a,e,n,i,l,g){function s(e,i,s){e[s.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:a(s.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[]},applyFilter:g.applyFilter};var r=e[s.tableName],o=l.get("tablelite/tablelite.tpl.html");r.items.paging.pageSize=r.items.paging.pageSizes[0],r.loadPage=function(a){var t,n,i=(a-1)*r.items.paging.pageSize,l=i+r.items.paging.pageSize;for(r.items.list=e.$eval(s.localDataSource).slice(i,l),r.items.paging.currentPage=a,r.items.paging.totalPages=Math.ceil(e.$eval(s.localDataSource).length/r.items.paging.pageSize),r.localConfig.pagingArray=[],n=Math.ceil(a/r.items.paging.pageSize)*r.items.paging.pageSize-(r.items.paging.pageSize-1),t=0;5>t;t++)n+t>0&&n+t<=r.items.paging.totalPages&&r.localConfig.pagingArray.push(n+t)},r.loadNextPage=function(){r.items.paging.currentPage+1<=r.items.paging.totalPages&&r.loadPage(r.items.paging.currentPage+1)},r.loadPreviousPage=function(){r.items.paging.currentPage-1>0&&r.loadPage(r.items.paging.currentPage-1)},r.pageSizeChanged=function(a){r.items.paging.pageSize=a,r.loadPage(1)},r.loadPage(1),s.tableClasses=s.tableClasses||"table",s.paginationClasses=s.paginationClasses||"pagination",o=o.replace(/%=tableName%/g,s.tableName).replace(/%=columnDefinition%/g,s.columnDefinition).replace(/%=paginationClasses%/g,s.paginationClasses).replace(/%=tableClasses%/g,s.tableClasses),angular.element(i).html(n(o)(e))}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).provider("$treebrowser",function(){var a=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:a}}}).directive("adTreeBrowser",["$compile","$http","$treebrowser","$templateCache",function(a,e,t,n){return{restrict:"E",link:function(i,l,g){var s=g.treeName||"",r=g.nodeTemplateUrl||"",o=g.nodeHeaderUrl||"",p=g.childrenPadding||15,c="",u=function(e,r){var o=n.get("treebrowser/treebrowser.tpl.html");c=o.replace(/%=treeName%/g,s).replace(/%=treeRootName%/g,g.treeRoot).replace(/%=bordered%/g,g.bordered).replace(/%=expandIconClass%/g,g.expandIconClass||t.settings.expandIconClass).replace(/%=collapseIconClass%/g,g.collapseIconClass||t.settings.collapseIconClass).replace(/%=loadingIconClass%/g,g.loadingIconClass||t.settings.loadingIconClass).replace(/%=childNodeName%/g,g.childNode).replace(/%=childrenPadding%/g,p).replace(/%=rowNgClass%/g,g.rowNgClass||"").replace(/%=nodeTemplate%/g,e).replace(/%=nodeHeaderTemplate%/g,r||""),l.empty(),l.append(a(c)(i))};i[s+"TreeBrowser"]={toggle:function(a,e){var t;a.stopPropagation(),t=i.$eval(g.toggleCallback),t?t(e):e._expanded=!e._expanded},hasChildren:function(a){var e=i.$eval(g.hasChildren),t=a[g.childNode]&&a[g.childNode].length>0;return e&&(t=e(a)),t},showHeader:""!==o?!0:!1},""!==r?e.get(r).success(function(a){""!==o?e.get(o).success(function(e){u(a,e)}):u(a,"")}):u('<span>{{ item.name || "" }}</span>')}}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(a){return{evalObjectProperty:function(a,e){var t=e.split(".");if(a)for(;t.length;)a&&(a=a[t.shift()]);return a},applyFilter:function(e,t){var n,i;return t&&(n=t.split(":"),i=n[1],e=i?a(n[0])(e,i):a(n[0])(e)),e}}}]).constant("adDebounce",function(a,e,t){var n,i,l,g,s;return function(){l=this,i=arguments,g=new Date;var r=function(){var o=new Date-g;e>o?n=setTimeout(r,e-o):(n=null,t||(s=a.apply(l,i)))},o=t&&!n;return n||(n=setTimeout(r,e)),o&&(s=a.apply(l,i)),s}}).provider("$adPaging",function(){var a=this.defaults={request:{start:"skip",pageSize:"limit",page:"page"},response:{totalItems:"data",itemsLocation:"pagination.totalCount"}};this.$get=function(e,t,n){return{loadPage:function(i,l,g){var s,r,o,p,c=(i-1)*l,u=e.defer(),d=angular.copy(a);return g.paginationConfig&&g.paginationConfig.request&&angular.extend(d.request,g.paginationConfig.request),g.paginationConfig&&g.paginationConfig.response&&angular.extend(d.response,g.paginationConfig.response),g.params[d.request.start]=c,g.params[d.request.pageSize]=l,g.params[d.request.page]=i,o=function(a){var e={items:n.evalObjectProperty(a,d.response.itemsLocation),currentPage:i,totalPages:Math.ceil(n.evalObjectProperty(a,d.response.totalItems)/l),pagingArray:[]};for(r=Math.ceil(i/l)*l-(l-1),s=0;5>s;s++)r+s>0&&r+s<=e.totalPages&&e.pagingArray.push(r+s);u.resolve(e)},p=function(a){u.reject(a)},"JSONP"===g.method?t.jsonp(g.url+"?callback=JSON_CALLBACK",g).success(o).error(p):t(g).success(o).error(p),u.promise}}}})}(window,document);