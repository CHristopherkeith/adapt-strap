/**
 * adapt-strap
 * @version v0.0.4 - 2014-07-27
 * @link https://github.com/Adaptv/adapt-strap
 * @author Kashyap Patel (kashyap@adap.tv)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(e,a,t){"use strict";angular.module("adaptv.adaptStrap",["adaptv.adaptStrap.treebrowser","adaptv.adaptStrap.tablelite","adaptv.adaptStrap.tableajax","adaptv.adaptStrap.utils"]),angular.module("adaptv.adaptStrap.tableajax",[]).provider("$tableajax",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTableAjax",["$parse","$http","$compile","$filter","$templateCache","$adPaging","adStrapUtils",function(e,a,i,n,l,g,s){function r(a,n,r){a[r.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(r.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[],disablePaging:!1},ajaxConfig:a.$eval(r.ajaxConfig),applyFilter:s.applyFilter};var o=a[r.tableName],p=l.get("tableajax/tableajax.tpl.html");o.items.paging.pageSize=o.items.paging.pageSizes[0],o.loadPage=function(e){o.localConfig.disablePaging||(o.localConfig.disablePaging=!0,g.loadPage(e,o.items.paging.pageSize,o.ajaxConfig).then(function(e){o.items.list=e.items,o.items.paging.totalPages=e.totalPages,o.items.paging.currentPage=e.currentPage,o.localConfig.pagingArray=e.pagingArray,o.localConfig.disablePaging=!1},function(){o.localConfig.disablePaging=!1}))},o.loadNextPage=function(){o.items.paging.currentPage+1<=o.items.paging.totalPages&&o.loadPage(o.items.paging.currentPage+1)},o.loadPreviousPage=function(){o.items.paging.currentPage-1>0&&o.loadPage(o.items.paging.currentPage-1)},o.pageSizeChanged=function(e){o.items.paging.pageSize=e,o.loadPage(o.items.paging.currentPage)},o.loadPage(1),r.tableClasses=r.tableClasses||"table",r.paginationClasses=r.paginationClasses||"pagination",p=p.replace(/%=tableName%/g,r.tableName).replace(/%=columnDefinition%/g,r.columnDefinition).replace(/%=tableClasses%/g,r.tableClasses).replace(/%=paginationClasses%/g,r.paginationClasses),angular.element(n).html(i(p)(a))}return{restrict:"E",link:r}}]),angular.module("adaptv.adaptStrap.tablelite",[]).provider("$tablelite",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTableLite",["$parse","$http","$compile","$filter","$templateCache","adStrapUtils",function(e,a,i,n,l,g){function s(a,n,s){a[s.tableName]={items:{list:t,paging:{currentPage:1,totalPages:t,pageSize:t,pageSizes:e(s.pageSizes)()||[10,25,50]}},localConfig:{pagingArray:[]},applyFilter:g.applyFilter};var r=a[s.tableName],o=l.get("tablelite/tablelite.tpl.html");r.items.paging.pageSize=r.items.paging.pageSizes[0],r.loadPage=function(e){var t,i,n=(e-1)*r.items.paging.pageSize,l=n+r.items.paging.pageSize;for(r.items.list=a.$eval(s.localDataSource).slice(n,l),r.items.paging.currentPage=e,r.items.paging.totalPages=Math.ceil(a.$eval(s.localDataSource).length/r.items.paging.pageSize),r.localConfig.pagingArray=[],i=Math.ceil(e/r.items.paging.pageSize)*r.items.paging.pageSize-(r.items.paging.pageSize-1),t=0;5>t;t++)i+t>0&&i+t<=r.items.paging.totalPages&&r.localConfig.pagingArray.push(i+t)},r.loadNextPage=function(){r.items.paging.currentPage+1<=r.items.paging.totalPages&&r.loadPage(r.items.paging.currentPage+1)},r.loadPreviousPage=function(){r.items.paging.currentPage-1>0&&r.loadPage(r.items.paging.currentPage-1)},r.pageSizeChanged=function(e){r.items.paging.pageSize=e,r.loadPage(r.items.paging.currentPage)},r.loadPage(1),s.tableClasses=s.tableClasses||"table",s.paginationClasses=s.paginationClasses||"pagination",o=o.replace(/%=tableName%/g,s.tableName).replace(/%=columnDefinition%/g,s.columnDefinition).replace(/%=paginationClasses%/g,s.paginationClasses).replace(/%=tableClasses%/g,s.tableClasses),angular.element(n).html(i(o)(a))}return{restrict:"E",link:s}}]),angular.module("adaptv.adaptStrap.treebrowser",[]).provider("$treebrowser",function(){var e=this.defaults={expandIconClass:"glyphicon glyphicon-plus-sign",collapseIconClass:"glyphicon glyphicon-minus-sign",loadingIconClass:"glyphicon glyphicon-refresh ad-spin"};this.$get=function(){return{settings:e}}}).directive("adTreeBrowser",["$compile","$http","$treebrowser","$templateCache",function(e,a,t,i){return{restrict:"E",link:function(n,l,g){var s=g.treeName||"",r=g.nodeTemplateUrl||"",o=g.nodeHeaderUrl||"",p=g.childrenPadding||15,c="",d=function(a,r){var o=i.get("treebrowser/treebrowser.tpl.html");c=o.replace(/%=treeName%/g,s).replace(/%=treeRootName%/g,g.treeRoot).replace(/%=bordered%/g,g.bordered).replace(/%=expandIconClass%/g,g.expandIconClass||t.settings.expandIconClass).replace(/%=collapseIconClass%/g,g.collapseIconClass||t.settings.collapseIconClass).replace(/%=loadingIconClass%/g,g.loadingIconClass||t.settings.loadingIconClass).replace(/%=childNodeName%/g,g.childNode).replace(/%=childrenPadding%/g,p).replace(/%=rowNgClass%/g,g.rowNgClass||"").replace(/%=nodeTemplate%/g,a).replace(/%=nodeHeaderTemplate%/g,r||""),l.empty(),l.append(e(c)(n))};n[s+"TreeBrowser"]={toggle:function(e,a){var t;e.stopPropagation(),t=n.$eval(g.toggleCallback),t?t(a):a._expanded=!a._expanded},hasChildren:function(e){var a=n.$eval(g.hasChildren),t=e[g.childNode]&&e[g.childNode].length>0;return a&&(t=a(e)),t},showHeader:""!==o?!0:!1},""!==r?a.get(r).success(function(e){""!==o?a.get(o).success(function(a){d(e,a)}):d(e,"")}):d('<span>{{ item.name || "" }}</span>')}}}]),angular.module("adaptv.adaptStrap.utils",[]).factory("adStrapUtils",["$filter",function(e){return{evalObjectProperty:function(e,a){for(var t=a.split(".");t.length;)e=e[t.shift()];return e},applyFilter:function(a,t){var i,n;return t&&(i=t.split(":"),n=i[1],a=n?e(i[0])(a,n):e(i[0])(a)),a}}}]).provider("$adPaging",function(){var e=this.defaults={request:{start:"skip",pageSize:"limit",page:"page"},response:{totalItems:"data",itemsLocation:"pagination.totalCount"}};this.$get=function(a,t,i){return{loadPage:function(n,l,g){var s,r,o,p,c=(n-1)*l,d=a.defer(),u=angular.copy(e);return g.paginationConfig&&g.paginationConfig.request&&angular.extend(u.request,g.paginationConfig.request),g.paginationConfig&&g.paginationConfig.response&&angular.extend(u.response,g.paginationConfig.response),g.params[u.request.start]=c,g.params[u.request.pageSize]=l,g.params[u.request.page]=n,o=function(e){var a={items:i.evalObjectProperty(e,u.response.itemsLocation),currentPage:n,totalPages:Math.ceil(i.evalObjectProperty(e,u.response.totalItems)/l),pagingArray:[]};for(r=Math.ceil(n/l)*l-(l-1),s=0;5>s;s++)r+s>0&&r+s<=a.totalPages&&a.pagingArray.push(r+s);d.resolve(a)},p=function(e){d.reject(e)},"JSONP"===g.method?t.jsonp(g.url+"?callback=JSON_CALLBACK",g).success(o).error(p):t(g).success(o).error(p),d.promise}}}})}(window,document);