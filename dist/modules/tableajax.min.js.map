{"version":3,"file":"tableajax.min.js","sources":["tableajax/tableajax.js"],"names":["angular","module","provider","defaults","this","expandIconClass","collapseIconClass","loadingIconClass","$get","settings","directive","$parse","$compile","$templateCache","$adPaging","adDebounce","adStrapUtils","_link","scope","element","attrs","tableName","items","list","undefined","paging","currentPage","totalPages","pageSize","pageSizes","localConfig","pagingArray","disablePaging","ajaxConfig","$eval","applyFilter","tableModels","mainTemplate","get","loadPage","page","then","response","loadNextPage","loadPreviousPage","pageSizeChanged","size","$watch","tableClasses","paginationClasses","replace","columnDefinition","html","restrict","link"],"mappings":"AAOAA,QAAQC,OAAO,kCAAmCC,SAAS,aAAc,WACvE,GAAIC,GAAWC,KAAKD,UAChBE,gBAAiB,gCACjBC,kBAAmB,iCACnBC,iBAAkB,sCAEtBH,MAAKI,KAAO,WACV,OAASC,SAAUN,MAEpBO,UAAU,eACX,SACA,WACA,iBACA,YACA,aACA,eACA,SAAUC,EAAQC,EAAUC,EAAgBC,EAAWC,EAAYC,GACjE,YACA,SAASC,GAAMC,EAAOC,EAASC,GAG7BF,EAAME,EAAMC,YACVC,OACEC,KAAMC,OACNC,QACEC,YAAa,EACbC,WAAYH,OACZI,SAAUJ,OACVK,UAAWlB,EAAOS,EAAMS,eACtB,GACA,GACA,MAINC,aACEC,eACAC,eAAe,GAEjBC,WAAYf,EAAMgB,MAAMd,EAAMa,YAC9BE,YAAanB,EAAamB,YAG5B,IAAIC,GAAclB,EAAME,EAAMC,WAAYgB,EAAexB,EAAeyB,IAAI,+BAC5EF,GAAYd,MAAMG,OAAOG,SAAWQ,EAAYd,MAAMG,OAAOI,UAAU,GAEvEO,EAAYG,SAAWxB,EAAW,SAAUyB,GACrCJ,EAAYN,YAAYE,gBAC3BI,EAAYN,YAAYE,eAAgB,EACxClB,EAAUyB,SAASC,EAAMJ,EAAYd,MAAMG,OAAOG,SAAUQ,EAAYH,YAAYQ,KAAK,SAAUC,GACjGN,EAAYd,MAAMC,KAAOmB,EAASpB,MAClCc,EAAYd,MAAMG,OAAOE,WAAae,EAASf,WAC/CS,EAAYd,MAAMG,OAAOC,YAAcgB,EAAShB,YAChDU,EAAYN,YAAYC,YAAcW,EAASX,YAC/CK,EAAYN,YAAYE,eAAgB,GACvC,WACDI,EAAYN,YAAYE,eAAgB,MAG3C,IAAI,GACPI,EAAYO,aAAe,WACrBP,EAAYd,MAAMG,OAAOC,YAAc,GAAKU,EAAYd,MAAMG,OAAOE,YACvES,EAAYG,SAASH,EAAYd,MAAMG,OAAOC,YAAc,IAGhEU,EAAYQ,iBAAmB,WACzBR,EAAYd,MAAMG,OAAOC,YAAc,EAAI,GAC7CU,EAAYG,SAASH,EAAYd,MAAMG,OAAOC,YAAc,IAGhEU,EAAYS,gBAAkB,SAAUC,GACtCV,EAAYd,MAAMG,OAAOG,SAAWkB,EACpCV,EAAYG,SAAS,IAIvBH,EAAYG,SAAS,GAErBrB,EAAM6B,OAAO3B,EAAMa,WAAY,WAC7BG,EAAYG,SAAS,KACpB,GACHnB,EAAM4B,aAAe5B,EAAM4B,cAAgB,QAC3C5B,EAAM6B,kBAAoB7B,EAAM6B,mBAAqB,aACrDZ,EAAeA,EAAaa,QAAQ,gBAAiB9B,EAAMC,WAAW6B,QAAQ,uBAAwB9B,EAAM+B,kBAAkBD,QAAQ,mBAAoB9B,EAAM4B,cAAcE,QAAQ,wBAAyB9B,EAAM6B,mBACrNjD,QAAQmB,QAAQA,GAASiC,KAAKxC,EAASyB,GAAcnB,IAEvD,OACEmC,SAAU,IACVC,KAAMrC","sourcesContent":["angular.module('adaptv.adaptStrap.tableajax', [])\n  .provider('$tableajax', function () {\n    var defaults = this.defaults = {\n      expandIconClass: 'glyphicon glyphicon-plus-sign',\n      collapseIconClass: 'glyphicon glyphicon-minus-sign',\n      loadingIconClass: 'glyphicon glyphicon-refresh ad-spin'\n    };\n    this.$get = function () {\n      return {\n        settings: defaults\n      };\n    };\n  })\n\n/**\n * Use this directive if you need to render a table that loads data from ajax.\n */\n  .directive('adTableAjax',\n  ['$parse', '$compile', '$templateCache', '$adPaging', 'adDebounce', 'adStrapUtils',\n    function ($parse, $compile, $templateCache, $adPaging, adDebounce, adStrapUtils) {\n      'use strict';\n      function _link(scope, element, attrs) {\n        // We do the name spacing so the if there are multiple adap-table-lite on the scope,\n        // they don't fight with each other.\n        scope[attrs.tableName] = {\n          items: {\n            list: undefined,\n            paging: {\n              currentPage: 1,\n              totalPages: undefined,\n              pageSize: undefined,\n              pageSizes: $parse(attrs.pageSizes)() || [10, 25, 50]\n            }\n          },\n          localConfig: {\n            pagingArray: [],\n            disablePaging: false\n          },\n          ajaxConfig: scope.$eval(attrs.ajaxConfig),\n          applyFilter: adStrapUtils.applyFilter\n        };\n\n        // ---------- Local data ---------- //\n        var tableModels = scope[attrs.tableName],\n          mainTemplate = $templateCache.get('tableajax/tableajax.tpl.html');\n        tableModels.items.paging.pageSize = tableModels.items.paging.pageSizes[0];\n\n        // ---------- ui handlers ---------- //\n        tableModels.loadPage = adDebounce(function (page) {\n          if (!tableModels.localConfig.disablePaging) {\n            tableModels.localConfig.disablePaging = true;\n            $adPaging.loadPage(page, tableModels.items.paging.pageSize, tableModels.ajaxConfig).then(\n              function (response) {\n                tableModels.items.list = response.items;\n                tableModels.items.paging.totalPages = response.totalPages;\n                tableModels.items.paging.currentPage = response.currentPage;\n                tableModels.localConfig.pagingArray = response.pagingArray;\n                tableModels.localConfig.disablePaging = false;\n              },\n              function () {\n                tableModels.localConfig.disablePaging = false;\n              }\n            );\n          }\n        }, 50, false);\n\n        tableModels.loadNextPage = function () {\n          if (tableModels.items.paging.currentPage + 1 <= tableModels.items.paging.totalPages) {\n            tableModels.loadPage(tableModels.items.paging.currentPage + 1);\n          }\n        };\n\n        tableModels.loadPreviousPage = function () {\n          if (tableModels.items.paging.currentPage - 1 > 0) {\n            tableModels.loadPage(tableModels.items.paging.currentPage - 1);\n          }\n        };\n\n        tableModels.pageSizeChanged = function (size) {\n          tableModels.items.paging.pageSize = size;\n          tableModels.loadPage(1);\n        };\n\n        // ---------- initialization and event listeners ---------- //\n        //We do the compile after injecting the name spacing into the template.\n        tableModels.loadPage(1);\n\n        // reset on parameter change\n        scope.$watch(attrs.ajaxConfig, function () {\n          tableModels.loadPage(1);\n        }, true);\n\n        attrs.tableClasses = attrs.tableClasses || 'table';\n        attrs.paginationClasses = attrs.paginationClasses || 'pagination';\n        mainTemplate = mainTemplate.replace(/%=tableName%/g, attrs.tableName).\n          replace(/%=columnDefinition%/g, attrs.columnDefinition).\n          replace(/%=tableClasses%/g, attrs.tableClasses).\n          replace(/%=paginationClasses%/g, attrs.paginationClasses);\n        angular.element(element).html($compile(mainTemplate)(scope));\n      }\n\n      return {\n        restrict: 'E',\n        link: _link\n      };\n    }]);\n"],"sourceRoot":"/source/"}