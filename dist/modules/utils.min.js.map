{"version":3,"file":"utils.min.js","sources":["utils/utils.js"],"names":["angular","module","factory","$filter","evalObjectProperty","obj","property","arr","split","length","shift","applyFilter","value","filter","parts","filterOptions","$timeout","$q","deb","func","delay","immediate","ctx","timer","deferred","defer","wait","context","this","args","arguments","callNow","later","resolve","apply","cancel","promise","$adConfig","$http","adStrapUtils","options","start","pageNumber","pageSize","pagingConfig","copy","paging","ajaxConfig","paginationConfig","request","extend","response","params","page","sortKey","sortField","sortDirection","sortAscValue","sortDescValue","method","jsonp","url","then","result","items","data","itemsLocation","currentPage","totalPages","Math","ceil","totalItems","pagingArray","token","TOTAL_PAGINATION_ITEMS","minimumBound","floor","i","push"],"mappings":"AAOAA,QAAQC,OAAO,8BAA+BC,QAAQ,gBACpD,UACA,SAAUC,GACR,OACEC,mBAAoB,SAAUC,EAAKC,GACjC,GAAIC,GAAMD,EAASE,MAAM,IACzB,IAAIH,EACF,KAAOE,EAAIE,QACLJ,IACFA,EAAMA,EAAIE,EAAIG,SAIpB,OAAOL,IAETM,YAAa,SAAUC,EAAOC,GAC5B,GAAIC,GAAOC,CAUX,OATIF,KACFC,EAAQD,EAAOL,MAAM,KACrBO,EAAgBD,EAAM,GAEpBF,EADEG,EACMZ,EAAQW,EAAM,IAAIF,EAAOG,GAEzBZ,EAAQW,EAAM,IAAIF,IAGvBA,OAIZV,QAAQ,cACT,WACA,KACA,SAAUc,EAAUC,GAClB,YACA,IAAIC,GAAM,SAAUC,EAAMC,EAAOC,EAAWC,GAC1C,GAAIC,GAAQ,KAAMC,EAAWP,EAAGQ,QAASC,EAAON,GAAS,GACzD,OAAO,YACL,GAAIO,GAAUL,GAAOM,KAAMC,EAAOC,UAAWC,EAAUV,IAAcE,EAAOS,EAAQ,WAC3EX,IACHG,EAASS,QAAQd,EAAKe,MAAMP,EAASE,IACrCL,EAAWP,EAAGQ,SAWpB,OARIF,IACFP,EAASmB,OAAOZ,GAElBA,EAAQP,EAASgB,EAAON,GACpBK,IACFP,EAASS,QAAQd,EAAKe,MAAMP,EAASE,IACrCL,EAAWP,EAAGQ,SAETD,EAASY,SAGpB,OAAOlB,MAERhB,QAAQ,cACT,YACA,QACA,eACA,SAAUmC,EAAWC,EAAOC,GAC1B,MAAO,UAAUC,GACf,GAAIC,IAASD,EAAQE,WAAa,GAAKF,EAAQG,SAAUC,EAAe5C,QAAQ6C,KAAKR,EAAUS,QAASC,EAAa/C,QAAQ6C,KAAKL,EAAQO,WACtIA,GAAWC,kBAAoBD,EAAWC,iBAAiBC,SAC7DjD,QAAQkD,OAAON,EAAaK,QAASF,EAAWC,iBAAiBC,SAE/DF,EAAWC,kBAAoBD,EAAWC,iBAAiBG,UAC7DnD,QAAQkD,OAAON,EAAaO,SAAUJ,EAAWC,iBAAiBG,UAEpEJ,EAAWK,OAAOR,EAAaK,QAAQR,OAASA,EAChDM,EAAWK,OAAOR,EAAaK,QAAQN,UAAYH,EAAQG,SAC3DI,EAAWK,OAAOR,EAAaK,QAAQI,MAAQb,EAAQE,WACnDF,EAAQc,UACVP,EAAWK,OAAOR,EAAaK,QAAQM,WAAaf,EAAQc,SAE1Dd,EAAQgB,iBAAkB,EAC5BT,EAAWK,OAAOR,EAAaK,QAAQO,eAAiBZ,EAAaK,QAAQQ,aACpEjB,EAAQgB,iBAAkB,IACnCT,EAAWK,OAAOR,EAAaK,QAAQO,eAAiBZ,EAAaK,QAAQS,cAE/E,IAAItB,EAMJ,OAJEA,GADwB,UAAtBW,EAAWY,OACHrB,EAAMsB,MAAMb,EAAWc,IAAM,0BAA2Bd,GAExDT,EAAMS,GAEXX,EAAQ0B,KAAK,SAAUC,GAU5B,IAAK,GATDZ,IACAa,MAAOzB,EAAanC,mBAAmB2D,EAAOE,KAAMrB,EAAaO,SAASe,eAC1EC,YAAa3B,EAAQE,WACrB0B,WAAYC,KAAKC,KAAK/B,EAAanC,mBAAmB2D,EAAOE,KAAMrB,EAAaO,SAASoB,YAAc/B,EAAQG,UAC/G6B,eACAC,MAAOjC,EAAQiC,OAEfC,EAAyB,EACzBC,EAAenC,EAAQE,WAAa2B,KAAKO,MAAMF,EAAyB,GACnEG,EAAIF,EAAcE,GAAKrC,EAAQE,WAAYmC,IAC9CA,EAAI,GACN1B,EAASqB,YAAYM,KAAKD,EAG9B,MAAO1B,EAASqB,YAAY/D,OAASiE,KAC/BG,EAAI1B,EAASiB,aAGjBjB,EAASqB,YAAYM,KAAKD,GAC1BA,GAEF,OAAO1B","sourcesContent":["angular.module('adaptv.adaptStrap.utils', [])\n  .factory('adStrapUtils', ['$filter', function ($filter) {\n    return {\n      evalObjectProperty: function (obj, property) {\n        var arr = property.split('.');\n        if (obj) {\n          while (arr.length) {\n            if (obj) {\n              obj = obj[arr.shift()];\n            }\n          }\n        }\n        return obj;\n      },\n      applyFilter: function (value, filter) {\n        var parts,\n          filterOptions;\n        if (filter) {\n          parts = filter.split(':');\n          filterOptions = parts[1];\n          if (filterOptions) {\n            value = $filter(parts[0])(value, filterOptions);\n          } else {\n            value = $filter(parts[0])(value);\n          }\n        }\n        return value;\n      }\n    };\n  }])\n  .factory('adDebounce', ['$timeout', '$q', function ($timeout, $q) {\n    'use strict';\n    var deb = function (func, delay, immediate, ctx) {\n      var timer = null,\n        deferred = $q.defer(),\n        wait = delay || 300;\n      return function () {\n        var context = ctx || this,\n          args = arguments,\n          callNow = immediate && !timer,\n          later = function () {\n            if (!immediate) {\n              deferred.resolve(func.apply(context, args));\n              deferred = $q.defer();\n            }\n          };\n        if (timer) {\n          $timeout.cancel(timer);\n        }\n        timer = $timeout(later, wait);\n        if (callNow) {\n          deferred.resolve(func.apply(context, args));\n          deferred = $q.defer();\n        }\n        return deferred.promise;\n      };\n    };\n\n    return deb;\n  }])\n  .factory('adLoadPage', ['$adConfig', '$http', 'adStrapUtils', function ($adConfig, $http, adStrapUtils) {\n    return function (options) {\n      var start = (options.pageNumber - 1) * options.pageSize,\n        pagingConfig = angular.copy($adConfig.paging),\n        ajaxConfig = angular.copy(options.ajaxConfig);\n\n      if (ajaxConfig.paginationConfig && ajaxConfig.paginationConfig.request) {\n        angular.extend(pagingConfig.request, ajaxConfig.paginationConfig.request);\n      }\n      if (ajaxConfig.paginationConfig && ajaxConfig.paginationConfig.response) {\n        angular.extend(pagingConfig.response, ajaxConfig.paginationConfig.response);\n      }\n\n      ajaxConfig.params[pagingConfig.request.start] = start;\n      ajaxConfig.params[pagingConfig.request.pageSize] = options.pageSize;\n      ajaxConfig.params[pagingConfig.request.page] = options.pageNumber;\n\n      if (options.sortKey) {\n        ajaxConfig.params[pagingConfig.request.sortField] = options.sortKey;\n      }\n\n      if (options.sortDirection === false) {\n        ajaxConfig.params[pagingConfig.request.sortDirection] = pagingConfig.request.sortAscValue;\n      } else if (options.sortDirection === true) {\n        ajaxConfig.params[pagingConfig.request.sortDirection] = pagingConfig.request.sortDescValue;\n      }\n\n      var promise;\n      if (ajaxConfig.method === 'JSONP') {\n        promise = $http.jsonp(ajaxConfig.url + '?callback=JSON_CALLBACK', ajaxConfig);\n      } else {\n        promise = $http(ajaxConfig);\n      }\n\n      return promise.then(function(result) {\n        var response = {\n          items: adStrapUtils.evalObjectProperty(result.data, pagingConfig.response.itemsLocation),\n          currentPage: options.pageNumber,\n          totalPages: Math.ceil(\n              adStrapUtils.evalObjectProperty(result.data, pagingConfig.response.totalItems) /\n              options.pageSize\n          ),\n          pagingArray: [],\n          token: options.token\n        };\n\n        var TOTAL_PAGINATION_ITEMS = 5;\n        var minimumBound = options.pageNumber - Math.floor(TOTAL_PAGINATION_ITEMS / 2);\n        for (var i = minimumBound; i <= options.pageNumber; i++) {\n          if (i > 0) {\n            response.pagingArray.push(i);\n          }\n        }\n        while (response.pagingArray.length < TOTAL_PAGINATION_ITEMS) {\n          if (i > response.totalPages) {\n            break;\n          }\n          response.pagingArray.push(i);\n          i++;\n        }\n\n        return response;\n      });\n    };\n  }]);\n"],"sourceRoot":"/source/"}