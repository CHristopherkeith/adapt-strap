{"version":3,"file":"utils.min.js","sources":["utils/utils.js"],"names":["angular","module","factory","$filter","evalObjectProperty","obj","property","arr","split","length","shift","applyFilter","value","filter","parts","filterOptions","constant","func","wait","immediate","timeout","args","context","timestamp","result","this","arguments","Date","later","last","setTimeout","apply","callNow","provider","defaults","request","start","pageSize","page","response","totalItems","itemsLocation","$get","$q","$http","adStrapUtils","loadPage","pageToLoad","ajaxConfig","i","startPagingPage","success","err","defer","pagingConfig","copy","paginationConfig","extend","params","res","items","currentPage","totalPages","Math","ceil","pagingArray","push","resolve","error","reject","method","jsonp","url","promise"],"mappings":"AAOAA,QAAQC,OAAO,8BAA+BC,QAAQ,gBACpD,UACA,SAAUC,GACR,OACEC,mBAAoB,SAAUC,EAAKC,GACjC,GAAIC,GAAMD,EAASE,MAAM,IACzB,IAAIH,EACF,KAAOE,EAAIE,QACLJ,IACFA,EAAMA,EAAIE,EAAIG,SAIpB,OAAOL,IAETM,YAAa,SAAUC,EAAOC,GAC5B,GAAIC,GAAOC,CAUX,OATIF,KACFC,EAAQD,EAAOL,MAAM,KACrBO,EAAgBD,EAAM,GAEpBF,EADEG,EACMZ,EAAQW,EAAM,IAAIF,EAAOG,GAEzBZ,EAAQW,EAAM,IAAIF,IAGvBA,OAIZI,SAAS,aAAc,SAAUC,EAAMC,EAAMC,GAC9C,GAAIC,GAASC,EAAMC,EAASC,EAAWC,CACvC,OAAO,YACLF,EAAUG,KACVJ,EAAOK,UACPH,EAAY,GAAII,KAChB,IAAIC,GAAQ,WACV,GAAIC,GAAO,GAAIF,MAASJ,CACbL,GAAPW,EACFT,EAAUU,WAAWF,EAAOV,EAAOW,IAEnCT,EAAU,KACLD,IACHK,EAASP,EAAKc,MAAMT,EAASD,MAI/BW,EAAUb,IAAcC,CAO5B,OANKA,KACHA,EAAUU,WAAWF,EAAOV,IAE1Bc,IACFR,EAASP,EAAKc,MAAMT,EAASD,IAExBG,KAERS,SAAS,YAAa,WACvB,GAAIC,GAAWT,KAAKS,UAChBC,SACEC,MAAO,OACPC,SAAU,QACVC,KAAM,QAERC,UACEC,WAAY,OACZC,cAAe,yBAGrBhB,MAAKiB,KAAO,SAAUC,EAAIC,EAAOC,GAC/B,OACEC,SAAU,SAAUC,EAAYV,EAAUW,GACxC,GAAyCC,GAAGC,EAAiBC,EAASC,EAAlEhB,GAASW,EAAa,GAAKV,EAA4CgB,EAAQV,EAAGU,QAASC,EAAetD,QAAQuD,KAAKrB,EAiC3H,OAhCIc,GAAWQ,kBAAoBR,EAAWQ,iBAAiBrB,SAC7DnC,QAAQyD,OAAOH,EAAanB,QAASa,EAAWQ,iBAAiBrB,SAE/Da,EAAWQ,kBAAoBR,EAAWQ,iBAAiBjB,UAC7DvC,QAAQyD,OAAOH,EAAaf,SAAUS,EAAWQ,iBAAiBjB,UAEpES,EAAWU,OAAOJ,EAAanB,QAAQC,OAASA,EAChDY,EAAWU,OAAOJ,EAAanB,QAAQE,UAAYA,EACnDW,EAAWU,OAAOJ,EAAanB,QAAQG,MAAQS,EAC/CI,EAAU,SAAUQ,GAClB,GAAIpB,IACAqB,MAAOf,EAAazC,mBAAmBuD,EAAKL,EAAaf,SAASE,eAClEoB,YAAad,EACbe,WAAYC,KAAKC,KAAKnB,EAAazC,mBAAmBuD,EAAKL,EAAaf,SAASC,YAAcH,GAC/F4B,eAGJ,KADAf,EAAkBa,KAAKC,KAAKjB,EAAaV,GAAYA,GAAYA,EAAW,GACvEY,EAAI,EAAO,EAAJA,EAAOA,IACbC,EAAkBD,EAAI,GAAKC,EAAkBD,GAAKV,EAASuB,YAC7DvB,EAAS0B,YAAYC,KAAKhB,EAAkBD,EAGhDI,GAAMc,QAAQ5B,IAEhBa,EAAM,SAAUgB,GACdf,EAAMgB,OAAOD,IAEW,UAAtBpB,EAAWsB,OACb1B,EAAM2B,MAAMvB,EAAWwB,IAAM,0BAA2BxB,GAAYG,QAAQA,GAASiB,MAAMhB,GAE3FR,EAAMI,GAAYG,QAAQA,GAASiB,MAAMhB,GAEpCC,EAAMoB","sourcesContent":["angular.module('adaptv.adaptStrap.utils', [])\n  .factory('adStrapUtils', ['$filter', function ($filter) {\n    return {\n      evalObjectProperty: function (obj, property) {\n        var arr = property.split('.');\n        if (obj) {\n          while (arr.length) {\n            if (obj) {\n              obj = obj[arr.shift()];\n            }\n          }\n        }\n        return obj;\n      },\n      applyFilter: function (value, filter) {\n        var parts,\n          filterOptions;\n        if (filter) {\n          parts = filter.split(':');\n          filterOptions = parts[1];\n          if (filterOptions) {\n            value = $filter(parts[0])(value, filterOptions);\n          } else {\n            value = $filter(parts[0])(value);\n          }\n        }\n        return value;\n      }\n    };\n  }])\n  // @source jashkenas/underscore\n  // @url https://github.com/jashkenas/underscore/blob/1.5.2/underscore.js#L693\n  .constant('adDebounce', function(func, wait, immediate) {\n    var timeout, args, context, timestamp, result;\n    return function() {\n      context = this;\n      args = arguments;\n      timestamp = new Date();\n      var later = function() {\n        var last = (new Date()) - timestamp;\n        if (last < wait) {\n          timeout = setTimeout(later, wait - last);\n        } else {\n          timeout = null;\n          if (!immediate) {\n            result = func.apply(context, args);\n          }\n        }\n      };\n      var callNow = immediate && !timeout;\n      if (!timeout) {\n        timeout = setTimeout(later, wait);\n      }\n      if (callNow) {\n        result = func.apply(context, args);\n      }\n      return result;\n    };\n  })\n  .provider('$adPaging', function () {\n    var defaults = this.defaults = {\n      request: {\n        start: 'skip',\n        pageSize: 'limit',\n        page: 'page'\n      },\n      response: {\n        totalItems: 'data',\n        itemsLocation: 'pagination.totalCount'\n      }\n    };\n\n    this.$get = function ($q, $http, adStrapUtils) {\n      return {\n        loadPage: function (pageToLoad, pageSize, ajaxConfig) {\n          var start = (pageToLoad - 1) * pageSize,\n            i,\n            startPagingPage,\n            success,\n            err,\n            defer = $q.defer(),\n            pagingConfig = angular.copy(defaults);\n\n          if (ajaxConfig.paginationConfig && ajaxConfig.paginationConfig.request) {\n            angular.extend(pagingConfig.request, ajaxConfig.paginationConfig.request);\n          }\n          if (ajaxConfig.paginationConfig && ajaxConfig.paginationConfig.response) {\n            angular.extend(pagingConfig.response, ajaxConfig.paginationConfig.response);\n          }\n\n          ajaxConfig.params[pagingConfig.request.start] = start;\n          ajaxConfig.params[pagingConfig.request.pageSize] = pageSize;\n          ajaxConfig.params[pagingConfig.request.page] = pageToLoad;\n\n          success = function (res) {\n            var response = {\n              items: adStrapUtils.evalObjectProperty(res, pagingConfig.response.itemsLocation),\n              currentPage: pageToLoad,\n              totalPages: Math.ceil(\n                  adStrapUtils.evalObjectProperty(res, pagingConfig.response.totalItems) /\n                  pageSize\n              ),\n              pagingArray: []\n            };\n            startPagingPage = (Math.ceil(pageToLoad / pageSize) * pageSize) - (pageSize - 1);\n            for (i = 0; i < 5; i++) {\n              if (startPagingPage + i > 0 && startPagingPage + i <= response.totalPages) {\n                response.pagingArray.push(startPagingPage + i);\n              }\n            }\n            defer.resolve(response);\n          };\n\n          err = function (error) {\n            defer.reject(error);\n          };\n\n          if (ajaxConfig.method === 'JSONP') {\n            $http.jsonp(ajaxConfig.url + '?callback=JSON_CALLBACK', ajaxConfig).success(success).error(err);\n          } else {\n            $http(ajaxConfig).success(success).error(err);\n          }\n          return defer.promise;\n        }\n      };\n    };\n  });\n"],"sourceRoot":"/source/"}